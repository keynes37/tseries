---
title: "Capstone 1"
subtitle: "<span class='hi pink'>Pronósticos Simples</span>"
author: "**Universidad del Norte** Eco 1731: Econometría II"
date: "<br> **Fecha Límite**: viernes, 29 Agosto 2025"
output: 
  xaringan::moon_reader:
    css: ['default', 'metropolis', 'metropolis-fonts', 'my-css.css']
    # self_contained: true
    nature:
      ratio: '8.5:11'
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
class: clear

```{R, setup, include = F}
# Packages
library(pacman)
p_load(
  ggplot2, gridExtra, ggthemes, latex2exp, kableExtra,
  tidyverse, broom, knitr, magrittr
)
# Colors
red_pink <- "#e64173"
turquoise <- "#20B2AA"
grey_light <- "grey70"
grey_mid <- "grey50"
grey_dark <- "grey20"
# Themes
theme_axes_y <- theme_void() + theme(
  text = element_text(family = "sans"),
  axis.title = element_text(size = 11),
  plot.title = element_text(size = 11, hjust = 0.5),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, -0.2, 0, 0, unit = "lines")),
  axis.text.y = element_text(
    size = 10, angle = 0, hjust = 0.9, vjust = 0.5,
    margin = margin(0, 0.4, 0, 0, unit = "lines")
  ),
  axis.line = element_line(
    color = grey_light,
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.07, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes_x <- theme_void() + theme(
  text = element_text(family = "sans"),
  axis.title = element_text(size = 11),
  plot.title = element_text(size = 11, hjust = 0.5),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, -0.2, 0, 0, unit = "lines")),
  axis.text.x = element_text(
    size = 10, angle = 0, hjust = 0.9, vjust = 0.5,
    margin = margin(0, 0.4, 0, 0, unit = "lines")
  ),
  axis.line = element_line(
    color = grey_light,
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.07, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_set(theme_gray(base_size = 11))
# Knitr options
opts_chunk$set(
  comment = "#>",
  fig.align = "center",
  warning = F,
  message = F
)
```

.mono[**ENTREGABLE**]: El proyecto debe ser realizado máximo por dos (2) personas. Para las **siguientes** preguntas conteste solo lo que se le pide. **No se acepta** ningún trabajo adicional a la fecha del _viernes 29 _ del presente mes hasta la hora de las 23:59 en la carpeta del brightspace disponible para esto y cuya entrega solo debe hacerla un/a (1) de los integrantes del grupo.

Las entregas debe hacerlas en la [Carpeta Capstone](https://cursos.uninorte.edu.co/d2l/home) respectiva. **Sus entregas debe ser uno de dos archivos**: (.hi[1]) Uno donde van todos los análisis que se piden y puede ser un documento *word* con nombre (_p.e._, .hi[yanesmola.docx]) u otro archivo (.hi[2]) Todo el trabajo en .mono[R] en documento pdf (el mas deseable) tambien nombrando a sus integrantes.

.mono[**OBJETIVO**]: Esto tiene tres intenciones: (1) re-forzar lo visto en clases; (2) Usted aprenda a preparar un informe con las herramientas de .mono[R];  y  ademas (3) ver que tan hábil es para resolver problemas con series de tiempo.

## Problema 1: Análisis de Tendencia

**1a.** Descargue los datos de la base del **World Bank** desde el siguiente link: [GDP por Países](https://datos.bancomundial.org/indicador/NY.GDP.MKTP.KN).  
Seleccione un país y tome una muestra de **15 observaciones anuales consecutivas** de su PIB real.  
Presente un **reporte de estadísticas descriptivas** de la serie (media, mediana, varianza, desviación estándar, mínimo, máximo, coeficiente de variación).

**1b.** Construya un **histograma de frecuencias** de la serie.  
- ¿La distribución parece simétrica o asimétrica?  
- ¿Existen valores atípicos?  
- ¿Qué información adicional le aporta este gráfico respecto a las estadísticas básicas?

**1c.** Analice el **componente de tendencia** de la serie.  
- ¿El PIB presenta crecimiento, decrecimiento o estabilidad?  
- ¿En qué periodos se observan cambios importantes en la dinámica?  

**1d.** Identifique el **tipo de tendencia básica** que mejor se ajusta a la serie (lineal, exponencial, cuadrática u otra).  
- Justifique su respuesta en función de la forma observada en los datos y gráficos.  

**1e.** Estime un **modelo de tendencia no lineal** para la serie.  
Ejemplo:  

$$Y_t^{\theta} = {\alpha_{0} + \alpha_{1} T_{t}^{\lambda} + \epsilon_t}$$

- Interprete los parámetros estimados.  
- ¿El ajuste del modelo es adecuado según las medidas de bondad de ajuste (R²)?  

---
class: clear

## Problema 2: Media y Varianza

Considere las siguientes distribuciones discretas.  
**Nota:** todos los cálculos deben realizarse **a mano**, mostrando cada paso sin usar R u otro software estadístico.

| F(x) | 0.22 | 0.17 | 0.18 | 0.05 | 0.02 | 0.36 |
|------|------|------|------|------|------|------|
| X    | 10   | -11  | 8    | 4    | 5    | -2   |

| F(y) | 0.14 | 0.18 | 0.09 | 0.19 | 0.30 | 0.10 |
|------|------|------|------|------|------|------|
| Y    | 2.2  | 3.7  | -2.2 | -1.8 | 4.2  | 5.3  |


**2a.** Verifique primero que cada tabla define una distribución válida (todas las probabilidades son no negativas y suman 1).  

Calcule:  

- **Media (valor esperado):**  

$$
E(X)=\sum_i x_i p_i, 
\qquad 
E(Y)=\sum_j y_j q_j
$$

- **Varianza:**  

$$
\mathrm{Var}(X)=\sum_i (x_i - E(X))^2 p_i,
\qquad 
\mathrm{Var}(Y)=\sum_j (y_j - E(Y))^2 q_j
$$  

> También puede usarse la forma alternativa:  
> $$\mathrm{Var}(X)=E(X^2)-[E(X)]^2$$ y análogo para $Y$.  

**Instrucción:** muestre paso a paso las sumas intermedias $E(X^2)$, $E(Y^2)$ y redondee al menos a 4 decimales.

**2b.** Para los siguientes procesos autorregresivos de orden 1 (AR(1)), halle la **media incondicional** $E(Y_t)$ y la **varianza incondicional** $\mathrm{Var}(Y_t)$.  

Recuerde que se deben hacer **a mano** usando fórmulas.

1. $Y_t = 1 + 0.35 Y_{t-1} + \varepsilon_t,\quad \varepsilon_t \sim (0,\;0.4)$

2. $Y_t = 1 + 0.93 Y_{t-1} + \varepsilon_t,\quad \varepsilon_t \sim (0,\;4)$

---
class: clear

**Guía teórica:**  
Para un AR(1) de la forma

$$Y_t = c + \phi Y_{t-1} + \varepsilon_t, \quad |\phi|<1$$

se cumple:  

$$E(Y_t) = \mu = \frac{c}{1-\phi},
\qquad 
\mathrm{Var}(Y_t) = \frac{\sigma_\varepsilon^2}{1-\phi^2}.$$

**Instrucción:**  
- Sustituya $c$, $\phi$ y $\sigma_\varepsilon^2$ en cada caso.  
- Verifique la condición de estacionariedad $|\phi|<1$.  
- Reporte $E(Y_t)$ y $\mathrm{Var}(Y_t)$ en cada modelo.  
- Compare los resultados y explique cómo influyen el valor de $\phi$ y la varianza del ruido $\sigma_\varepsilon^2$.

## Problema 3: Aprenda de Máxima verosimilitud

**3a.** Plantee la función de máxima verosimilitud en términos logarítmicos y halle el parámetro (estimador) de $(\beta_{0})$ de la función:
$$\mathcal{L} \left ( \mu \right )=  \frac{1}{\left (2\pi\sigma^{2}\right )^{n/2}}  exp \left \{ -\frac{1}{2\sigma^{2}} \sum \limits_{i=1}^{n} \left ( y_{i}-\beta_{0}-\beta_{1}x_{i} \right )^{2} \right \}$$
**3b.** Cuál viene a ser el resultado del parámetro de $\beta_{1}$? (demuestrelo y explique cada paso de la ecuación)

## Problema 4: Empalme

Use la base de datos proporcionada en el archivo de excel denominado .hi[Empalme práctico.xls], Hace referencia a una serie de tiempo con base a dos versiones o fechas constantes de manera histórica. <br/>

**4.a** Establezca las estadísticas descriptivas de las series.

**4.b** Realice un empalme hacia adelante de estas series.

## Problema 5: Medias Moviles

Extraiga la serie `DriversKilled` y verifique su estructura (`class`, `frequency`, rango de fechas). Luego grafique la serie y describa la **tendencia** y **estacionalidad** observadas.

```r
# Cargue el paquete 
library(datasets)
# Cargar el dataset Seatbelts
data("Seatbelts")

# Extraer la serie que vamos a usar
y <- Seatbelts[, "DriversKilled"]

# Verificar estructura
start(y); end(y); frequency(y); class(y)
```
---
class: clear

**5a. Preparación de datos** ¿Se aprecia una tendencia clara (creciente o decreciente) en la serie?. ¿Existe estacionalidad? ¿La amplitud parece constante o proporcional al nivel?  


**5b. Medias móviles (MA)**  ¿Cuál media móvil captura mejor la **tendencia de fondo**?  ¿Qué trade-off observa entre **suavización** y **rezago**?  

**5c. Descomposición estacional** ¿La estacionalidad es aproximadamente **constante (aditiva)** o **proporcional al nivel (multiplicativa)**?. ¿Qué le dicen los residuos de la descomposición sobre variaciones no explicadas?  
**5d. Holt (sin estacionalidad)**. Interprete los parámetros de nivel y tendencia en dicho modelo. ¿Se observa patrón estacional en los residuos? ¿Qué implicaría esto?  

**5e. Holt-Winters estacional aditivo**  Realice un modelo HWA ¿Mejora el ajuste respecto a Holt? ¿Qué muestran los residuos sobre estacionalidad remanente y autocorrelación?  

**4f. Holt-Winters estacional multiplicativo** Haga ahora la estimación de un modelo HWM. ¿Tiene sentido un esquema multiplicativo en esta serie? *Compare métricas (MAE, RMSE, MAPE) con el modelo aditivo*.  

**4g. Tendencia amortiguada (damped Holt)** Finalmente estime un modelo HWd. ¿Cómo cambia la proyección de largo plazo frente a Holt no amortiguado? Interprete el valor estimado de $\phi$ en términos de **amortiguación de tendencia**.  

**4h. Comparación de desempeño**  
- ¿Qué modelo ofrece menor error de pronóstico (MAE, RMSE, MAPE)?  
- ¿Cuál elegiría para predecir y por qué?  

**4i. Discusión final**  
- ¿Qué modelo equilibra mejor **ajuste, interpretabilidad y estabilidad**?
- ¿Qué diferencia práctica observa entre usar un modelo **aditivo vs. multiplicativo**?  
- ¿Por qué puede ser prudente preferir la **amortiguación de tendencia** en proyecciones de largo plazo?  
- Comente por qué un **cambio institucional o estructural** (como una nueva política) puede limitar la capacidad predictiva de estos métodos.  




